{
    "name": "aws-crt-nodejs",
    "hosts": {
        "manylinux": {
            "enabled": false
        }
    },
    "targets": {
        "android": {
            "enabled": false
        },
        "linux": {
            "x86": {
                "enabled": false
            }
        }
    },
    "imports": ["nodejs", "s2n"],
    "upstream": [],
    "downstream": [],
    "build_steps": [
        ["git", "submodule", "update", "--init", "--recursive"],
        ["npm", "install", "--ignore-scripts"],
        [
            "node", "node_modules/.bin/cmake-js", "compile",
            "--out={build_dir}",
            "--CDLibCrypto_INCLUDE_DIR={source_dir}/{libcrypto_path}/include",
            "--CDLibCrypto_STATIC_LIBRARY={source_dir}/{libcrypto_path}/lib/libcrypto.a",
            "--CDLibCrypto_SHARED_LIBRARY={source_dir}/{libcrypto_path}/lib/libcrypto.so",
            "--CDCMAKE_EXPORT_COMPILE_COMMANDS=ON",
            "-T", "install"
        ],
        ["npm", "run-script", "tsc"]
    ],
    "test_steps": [
        ["env", "AWS_CRT_MEMORY_TRACING=2", "npm", "test"]
    ]
}
